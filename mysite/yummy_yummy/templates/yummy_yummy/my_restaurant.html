{% extends "yummy_yummy/base.html" %}
{% load static %}

{% block title %}My restaurant{% endblock %}
{% block content %}

        {% if not user.is_authenticated %}
            <br>
            <br>
            <br>
            <h1>Please <a href="{% url 'login' %}">sign in</a></h1>
        {% endif %}
        
        {% if user.is_authenticated %}
            {% if has_restaurant %}
                {% if user.profile.usertype == 'seller' %}
                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <a href="{% url 'add-product' res_id=my_restaurant_id.Restaurant_ID %}">
                            <button class="btn btn-primary" type="button">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2"/>
                                </svg>
                                Add Product
                            </button>
                        </a>
                        
                    </div>
                    <p class="text-start"> this {{ name }}'s product.</p>
                    
                    <center>
                        {% for row in allrow %}
                        <div class="row row-cols-1 row-cols-md-3 md-3 test-center">
                            {% for c in row %}
                            <div class="col">
                                <div class="card" style="width: 18rem;">
                                {% if c.picture %}
                                <img src="{{ c.picture.url }}" height="350" alt="picture" class="card-img-top">
                                {% endif %}
                                <div class="card-body">
                                    <h5 class="card-title">{{ c.title }}</h5>
                                    <p class="card-text">
                                    price : {{ c.price }} à¸¿ <br>
                                    description : {{ c.description }} <br>
                                    available : {{ c.available }} <br>
                                    </p>
                                    <a href="#" class="btn btn-primary">more detail</a>
                                </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        {% endfor %}
                    </center>
                    <hr>
                    <p>DEBUG: {{ myproduct }}</p>
                    <p>Has next: {{ myproduct.has_next }}</p>
                    <p>Has previous: {{ myproduct.has_previous }}</p>
                    <p>Total pages: {{ myproduct.paginator.num_pages }}</p>

                    <nav aria-label="...">
                        <ul class="pagination">
                        {% if myproduct.has_previous %}
                            <li class="page-item">
                            <a class="page-link" href="?page={{ myproduct.previous_page_number }}">Previous</a>
                            </li>

                            {% if myproduct.number|add:-2 > 0  %}
                                <li class="page-item">
                                    <a class="page-link" href="?page={{myproduct.number|add:-2}}">{{myproduct.number|add:-2}}</a>
                                </li>
                            {% endif %}

                            {% if myproduct.number > 1  %}
                                <li class="page-item">
                                    <a class="page-link" href="?page={{myproduct.number|add:-1}}">{{myproduct.number|add:-1}}</a>
                                </li>
                            {% endif %}

                            {% if myproduct.has_next != True %}
                                <li class="page-item active">
                                <a class="page-link" href="{{myproduct.number}}">{{myproduct.number}}</a>
                                </li>
                            {% endif %}

                        {% endif %}  


                        {% if myproduct.has_next %}
                            <li class="page-item active">
                            <a class="page-link" href="{{myproduct.number}}">{{myproduct.number}}</a>
                            </li>

                            {% if myproduct.paginator.num_pages > myproduct.number %}
                            <li class="page-item">
                                <a class="page-link" href="?page={{myproduct.number|add:1}}">{{myproduct.number|add:1}}</a>
                            </li>
                            {% endif %}

                            {% if myproduct.paginator.num_pages > myproduct.number|add:1 %}
                            <li class="page-item">
                                <a class="page-link" href="?page={{myproduct.number|add:2}}">{{myproduct.number|add:2}}</a>
                            </li>
                            {% endif %}

                            <li class="page-item">
                            <a class="page-link" href="?page={{myproduct.number|add:1}}">Next</a>
                            </li>
                        {% endif %}

                        </ul>
                        <p> page {{myproduct.number}} from {{myproduct.paginator.num_pages}} </p>
                    </nav>
                {% else %}
                    <h1>Your are not seller</h1>
                {% endif %}
            {% else %}
                <p>You don't have a restaurant yet. <a href="{% url 'register-myrestaurant' %}">Regiter my restaurant</a> </p> 
            {% endif %}
        {% endif %}

{% endblock content %}